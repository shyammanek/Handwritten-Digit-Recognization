{"id":"node_modules/@tensorflow/tfjs-core/dist/optimizers/rmsprop_optimizer.js","dependencies":[{"name":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\optimizers\\rmsprop_optimizer.js.map","includedInParent":true,"mtime":499162500000},{"name":"E:\\htr-final\\package.json","includedInParent":true,"mtime":1603094551417},{"name":"E:\\htr-final\\.babelrc","includedInParent":true,"mtime":1603022514142},{"name":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\package.json","includedInParent":true,"mtime":1603088140582},{"name":"../environment","loc":{"line":13,"column":28},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\optimizers\\rmsprop_optimizer.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\environment.js"},{"name":"../globals","loc":{"line":14,"column":24},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\optimizers\\rmsprop_optimizer.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\globals.js"},{"name":"../ops/ops","loc":{"line":15,"column":20},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\optimizers\\rmsprop_optimizer.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\ops.js"},{"name":"../serialization","loc":{"line":16,"column":30},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\optimizers\\rmsprop_optimizer.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\serialization.js"},{"name":"./optimizer","loc":{"line":17,"column":26},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\optimizers\\rmsprop_optimizer.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\optimizers\\optimizer.js"}],"generated":{"js":"\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar environment_1 = require(\"../environment\");\nvar globals_1 = require(\"../globals\");\nvar ops_1 = require(\"../ops/ops\");\nvar serialization_1 = require(\"../serialization\");\nvar optimizer_1 = require(\"./optimizer\");\nvar RMSPropOptimizer = (function (_super) {\n    __extends(RMSPropOptimizer, _super);\n    function RMSPropOptimizer(learningRate, decay, momentum, epsilon, centered) {\n        if (decay === void 0) { decay = 0.9; }\n        if (momentum === void 0) { momentum = 0.0; }\n        if (epsilon === void 0) { epsilon = null; }\n        if (centered === void 0) { centered = false; }\n        var _this = _super.call(this) || this;\n        _this.learningRate = learningRate;\n        _this.decay = decay;\n        _this.momentum = momentum;\n        _this.epsilon = epsilon;\n        _this.accumulatedMeanSquares = {};\n        _this.accumulatedMeanGrads = {};\n        _this.accumulatedMoments = {};\n        _this.c = globals_1.keep(ops_1.scalar(learningRate));\n        _this.decayScalar = globals_1.keep(ops_1.scalar(decay));\n        _this.momentumScalar = globals_1.keep(ops_1.scalar(momentum));\n        _this.oneMinusDecay = globals_1.keep(ops_1.scalar(1 - decay));\n        _this.centered = centered;\n        if (epsilon === null) {\n            epsilon = environment_1.ENV.get('EPSILON');\n        }\n        _this.epsilonScalar = globals_1.keep(ops_1.scalar(epsilon));\n        return _this;\n    }\n    RMSPropOptimizer.prototype.applyGradients = function (variableGradients) {\n        var _this = this;\n        var _loop_1 = function (variableName) {\n            var value = environment_1.ENV.engine.registeredVariables[variableName];\n            if (this_1.accumulatedMeanSquares[variableName] == null) {\n                var trainable_1 = false;\n                globals_1.tidy(function () {\n                    _this.accumulatedMeanSquares[variableName] =\n                        ops_1.zerosLike(value).variable(trainable_1);\n                });\n            }\n            if (this_1.accumulatedMeanGrads[variableName] == null && this_1.centered) {\n                var trainable_2 = false;\n                globals_1.tidy(function () {\n                    _this.accumulatedMeanGrads[variableName] =\n                        ops_1.zerosLike(value).variable(trainable_2);\n                });\n            }\n            if (this_1.accumulatedMoments[variableName] == null) {\n                var trainable_3 = false;\n                globals_1.tidy(function () {\n                    _this.accumulatedMoments[variableName] =\n                        ops_1.zerosLike(value).variable(trainable_3);\n                });\n            }\n            var accumulatedMeanSquare = this_1.accumulatedMeanSquares[variableName];\n            var accumulatedMeanGrad = this_1.accumulatedMeanGrads[variableName];\n            var accumulatedMoments = this_1.accumulatedMoments[variableName];\n            var gradient = variableGradients[variableName];\n            globals_1.tidy(function () {\n                var newAccumulatedMeanSquare = _this.decayScalar.mul(accumulatedMeanSquare)\n                    .add(_this.oneMinusDecay.mul(gradient.square()));\n                if (_this.centered) {\n                    var newAccumulatedMeanGrad = _this.decayScalar.mul(accumulatedMeanGrad)\n                        .add(_this.oneMinusDecay.mul(gradient));\n                    var newAccumulatedMoments = _this.momentumScalar.mul(accumulatedMoments)\n                        .add(_this.c.mul(gradient).div(newAccumulatedMeanSquare\n                        .sub(newAccumulatedMeanGrad.square().add(_this.epsilonScalar))\n                        .sqrt()));\n                    _this.accumulatedMeanSquares[variableName].assign(newAccumulatedMeanSquare);\n                    _this.accumulatedMeanGrads[variableName].assign(newAccumulatedMeanGrad);\n                    _this.accumulatedMoments[variableName].assign(newAccumulatedMoments);\n                    var newValue = value.sub(newAccumulatedMoments);\n                    value.assign(newValue);\n                }\n                else {\n                    var newAccumulatedMeanSquare_1 = _this.decayScalar.mul(accumulatedMeanSquare)\n                        .add(_this.oneMinusDecay.mul(gradient.square()));\n                    var newAccumulatedMoments = _this.momentumScalar.mul(accumulatedMoments)\n                        .add(_this.c.mul(gradient).div(newAccumulatedMeanSquare_1.add(_this.epsilonScalar).sqrt()));\n                    _this.accumulatedMeanSquares[variableName].assign(newAccumulatedMeanSquare_1);\n                    _this.accumulatedMoments[variableName].assign(newAccumulatedMoments);\n                    var newValue = value.sub(newAccumulatedMoments);\n                    value.assign(newValue);\n                }\n            });\n        };\n        var this_1 = this;\n        for (var variableName in variableGradients) {\n            _loop_1(variableName);\n        }\n    };\n    RMSPropOptimizer.prototype.dispose = function () {\n        var _this = this;\n        this.c.dispose();\n        this.epsilonScalar.dispose();\n        this.decayScalar.dispose();\n        this.momentumScalar.dispose();\n        this.oneMinusDecay.dispose();\n        if (this.accumulatedMeanSquares != null) {\n            Object.keys(this.accumulatedMeanSquares)\n                .forEach(function (name) { return _this.accumulatedMeanSquares[name].dispose(); });\n        }\n        if (this.accumulatedMeanGrads != null && this.centered) {\n            Object.keys(this.accumulatedMeanGrads)\n                .forEach(function (name) { return _this.accumulatedMeanGrads[name].dispose(); });\n        }\n        if (this.accumulatedMoments != null) {\n            Object.keys(this.accumulatedMoments)\n                .forEach(function (name) { return _this.accumulatedMoments[name].dispose(); });\n        }\n    };\n    RMSPropOptimizer.prototype.getConfig = function () {\n        return {\n            learningRate: this.learningRate,\n            decay: this.decay,\n            momentum: this.momentum,\n            epsilon: this.epsilon,\n            centered: this.centered\n        };\n    };\n    RMSPropOptimizer.fromConfig = function (cls, config) {\n        return new cls(config.learningRate, config.decay, config.momentum, config.epsilon, config.centered);\n    };\n    RMSPropOptimizer.className = 'RMSPropOptimizer';\n    return RMSPropOptimizer;\n}(optimizer_1.Optimizer));\nexports.RMSPropOptimizer = RMSPropOptimizer;\nserialization_1.registerClass(RMSPropOptimizer);\n"},"sourceMaps":{"js":{"version":3,"file":"rmsprop_optimizer.js","sourceRoot":"","sources":["../../src/optimizers/rmsprop_optimizer.ts"],"names":[],"mappings":";;;;;;;;;;;;AAiBA,8CAAmC;AACnC,sCAAsC;AACtC,kCAA6C;AAC7C,kDAAkG;AAGlG,yCAAsC;AAGtC;IAAsC,oCAAS;IAa7C,0BACc,YAAoB,EAAY,KAAW,EAC3C,QAAc,EAAY,OAAsB,EAC1D,QAAgB;QAF0B,sBAAA,EAAA,WAAW;QAC3C,yBAAA,EAAA,cAAc;QAAY,wBAAA,EAAA,cAAsB;QAC1D,yBAAA,EAAA,gBAAgB;QAHpB,YAIE,iBAAO,SAaR;QAhBa,kBAAY,GAAZ,YAAY,CAAQ;QAAY,WAAK,GAAL,KAAK,CAAM;QAC3C,cAAQ,GAAR,QAAQ,CAAM;QAAY,aAAO,GAAP,OAAO,CAAe;QANtD,4BAAsB,GAAqB,EAAE,CAAC;QAC9C,0BAAoB,GAAqB,EAAE,CAAC;QAC5C,wBAAkB,GAAqB,EAAE,CAAC;QAQhD,KAAI,CAAC,CAAC,GAAG,cAAI,CAAC,YAAM,CAAC,YAAY,CAAC,CAAC,CAAC;QACpC,KAAI,CAAC,WAAW,GAAG,cAAI,CAAC,YAAM,CAAC,KAAK,CAAC,CAAC,CAAC;QACvC,KAAI,CAAC,cAAc,GAAG,cAAI,CAAC,YAAM,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC7C,KAAI,CAAC,aAAa,GAAG,cAAI,CAAC,YAAM,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC;QAC7C,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAEzB,IAAI,OAAO,KAAK,IAAI,EAAE;YACpB,OAAO,GAAG,iBAAG,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;SAC9B;QAED,KAAI,CAAC,aAAa,GAAG,cAAI,CAAC,YAAM,CAAC,OAAO,CAAC,CAAC,CAAC;;IAC7C,CAAC;IAED,yCAAc,GAAd,UAAe,iBAAmC;QAAlD,iBA6EC;gCA5EY,YAAY;YACrB,IAAM,KAAK,GAAG,iBAAG,CAAC,MAAM,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC;YAC3D,IAAI,OAAK,sBAAsB,CAAC,YAAY,CAAC,IAAI,IAAI,EAAE;gBACrD,IAAM,WAAS,GAAG,KAAK,CAAC;gBACxB,cAAI,CAAC;oBACH,KAAI,CAAC,sBAAsB,CAAC,YAAY,CAAC;wBACrC,eAAS,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,WAAS,CAAC,CAAC;gBAC3C,CAAC,CAAC,CAAC;aACJ;YACD,IAAI,OAAK,oBAAoB,CAAC,YAAY,CAAC,IAAI,IAAI,IAAI,OAAK,QAAQ,EAAE;gBACpE,IAAM,WAAS,GAAG,KAAK,CAAC;gBACxB,cAAI,CAAC;oBACH,KAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC;wBACnC,eAAS,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,WAAS,CAAC,CAAC;gBAC3C,CAAC,CAAC,CAAC;aACJ;YACD,IAAI,OAAK,kBAAkB,CAAC,YAAY,CAAC,IAAI,IAAI,EAAE;gBACjD,IAAM,WAAS,GAAG,KAAK,CAAC;gBACxB,cAAI,CAAC;oBACH,KAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC;wBACjC,eAAS,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,WAAS,CAAC,CAAC;gBAC3C,CAAC,CAAC,CAAC;aACJ;YAED,IAAM,qBAAqB,GAAG,OAAK,sBAAsB,CAAC,YAAY,CAAC,CAAC;YACxE,IAAM,mBAAmB,GAAG,OAAK,oBAAoB,CAAC,YAAY,CAAC,CAAC;YACpE,IAAM,kBAAkB,GAAG,OAAK,kBAAkB,CAAC,YAAY,CAAC,CAAC;YACjE,IAAM,QAAQ,GAAG,iBAAiB,CAAC,YAAY,CAAC,CAAC;YAEjD,cAAI,CAAC;gBACH,IAAM,wBAAwB,GAC1B,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,qBAAqB,CAAC;qBACtC,GAAG,CAAC,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;gBAExD,IAAI,KAAI,CAAC,QAAQ,EAAE;oBAEjB,IAAM,sBAAsB,GACxB,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,mBAAmB,CAAC;yBACpC,GAAG,CAAC,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;oBAE/C,IAAM,qBAAqB,GACvB,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,kBAAkB,CAAC;yBACtC,GAAG,CAAC,KAAI,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,GAAG,CACzB,wBAAwB;yBACnB,GAAG,CAAC,sBAAsB,CAAC,MAAM,EAAE,CAAC,GAAG,CACpC,KAAI,CAAC,aAAa,CAAC,CAAC;yBACvB,IAAI,EAAE,CAAC,CAAC,CAAC;oBAE1B,KAAI,CAAC,sBAAsB,CAAC,YAAY,CAAC,CAAC,MAAM,CAC5C,wBAAwB,CAAC,CAAC;oBAC9B,KAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,CAAC,MAAM,CAC1C,sBAAsB,CAAC,CAAC;oBAC5B,KAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC;oBAEpE,IAAM,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;oBAClD,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;iBACxB;qBAAM;oBAEL,IAAM,0BAAwB,GAC1B,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,qBAAqB,CAAC;yBACtC,GAAG,CAAC,KAAI,CAAC,aAAa,CAAC,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;oBAExD,IAAM,qBAAqB,GACvB,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,kBAAkB,CAAC;yBACtC,GAAG,CAAC,KAAI,CAAC,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,GAAG,CACzB,0BAAwB,CAAC,GAAG,CAAC,KAAI,CAAC,aAAa,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;oBAEtE,KAAI,CAAC,sBAAsB,CAAC,YAAY,CAAC,CAAC,MAAM,CAC5C,0BAAwB,CAAC,CAAC;oBAC9B,KAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC;oBAEpE,IAAM,QAAQ,GAAG,KAAK,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;oBAClD,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;iBACxB;YACH,CAAC,CAAC,CAAC;QACL,CAAC;;QA3ED,KAAK,IAAM,YAAY,IAAI,iBAAiB;oBAAjC,YAAY;SA2EtB;IACH,CAAC;IAED,kCAAO,GAAP;QAAA,iBAkBC;QAjBC,IAAI,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;QACjB,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC;QAC7B,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;QAC3B,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAC;QAC9B,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,CAAC;QAC7B,IAAI,IAAI,CAAC,sBAAsB,IAAI,IAAI,EAAE;YACvC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,sBAAsB,CAAC;iBACnC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAA3C,CAA2C,CAAC,CAAC;SACnE;QACD,IAAI,IAAI,CAAC,oBAAoB,IAAI,IAAI,IAAI,IAAI,CAAC,QAAQ,EAAE;YACtD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,oBAAoB,CAAC;iBACjC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAAzC,CAAyC,CAAC,CAAC;SACjE;QACD,IAAI,IAAI,CAAC,kBAAkB,IAAI,IAAI,EAAE;YACnC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC;iBAC/B,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAAvC,CAAuC,CAAC,CAAC;SAC/D;IACH,CAAC;IAED,oCAAS,GAAT;QACE,OAAO;YACL,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,QAAQ,EAAE,IAAI,CAAC,QAAQ;SACxB,CAAC;IACJ,CAAC;IACM,2BAAU,GAAjB,UACI,GAA+B,EAAE,MAAkB;QACrD,OAAO,IAAI,GAAG,CACV,MAAM,CAAC,YAAY,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,QAAQ,EAAE,MAAM,CAAC,OAAO,EAClE,MAAM,CAAC,QAAQ,CAAC,CAAC;IACvB,CAAC;IAhJM,0BAAS,GAAG,kBAAkB,CAAC;IAiJxC,uBAAC;CAAA,AAlJD,CAAsC,qBAAS,GAkJ9C;AAlJY,4CAAgB;AAmJ7B,6BAAa,CAAC,gBAAgB,CAAC,CAAC","sourcesContent":[null]}},"error":null,"hash":"217edfd89e698b654a7918f0804f1c4f","cacheData":{"env":{}}}