{"id":"node_modules/@tensorflow/tfjs-core/dist/ops/linalg_ops.js","dependencies":[{"name":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js.map","includedInParent":true,"mtime":499162500000},{"name":"E:\\htr-final\\package.json","includedInParent":true,"mtime":1603094551417},{"name":"E:\\htr-final\\.babelrc","includedInParent":true,"mtime":1603022514142},{"name":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\package.json","includedInParent":true,"mtime":1603088140582},{"name":"../environment","loc":{"line":3,"column":28},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\environment.js"},{"name":"../globals","loc":{"line":4,"column":24},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\globals.js"},{"name":"../util","loc":{"line":5,"column":21},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\util.js"},{"name":"./array_ops","loc":{"line":6,"column":26},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\array_ops.js"},{"name":"./concat_split","loc":{"line":7,"column":29},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\concat_split.js"},{"name":"./norm","loc":{"line":8,"column":21},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\norm.js"},{"name":"./operation","loc":{"line":9,"column":26},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\operation.js"},{"name":"./reduction_ops","loc":{"line":10,"column":30},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\reduction_ops.js"},{"name":"./tensor_ops","loc":{"line":11,"column":27},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\linalg_ops.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\tensor_ops.js"}],"generated":{"js":"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar environment_1 = require(\"../environment\");\nvar globals_1 = require(\"../globals\");\nvar util_1 = require(\"../util\");\nvar array_ops_1 = require(\"./array_ops\");\nvar concat_split_1 = require(\"./concat_split\");\nvar norm_1 = require(\"./norm\");\nvar operation_1 = require(\"./operation\");\nvar reduction_ops_1 = require(\"./reduction_ops\");\nvar tensor_ops_1 = require(\"./tensor_ops\");\nfunction gramSchmidt_(xs) {\n    var inputIsTensor2D;\n    if (Array.isArray(xs)) {\n        inputIsTensor2D = false;\n        util_1.assert(xs != null && xs.length > 0, 'Gram-Schmidt process: input must not be null, undefined, or empty');\n        var dim = xs[0].shape[0];\n        for (var i = 1; i < xs.length; ++i) {\n            util_1.assert(xs[i].shape[0] === dim, 'Gram-Schmidt: Non-unique lengths found in the input vectors: ' +\n                (\"(\" + xs[i].shape[0] + \" vs. \" + dim + \")\"));\n        }\n    }\n    else {\n        inputIsTensor2D = true;\n        xs = concat_split_1.split(xs, xs.shape[0], 0).map(function (x) { return array_ops_1.squeeze(x, [0]); });\n    }\n    util_1.assert(xs.length <= xs[0].shape[0], \"Gram-Schmidt: Number of vectors (\" + xs.length + \") exceeds \" +\n        (\"number of dimensions (\" + xs[0].shape[0] + \").\"));\n    var ys = [];\n    var xs1d = xs;\n    var _loop_1 = function (i) {\n        ys.push(environment_1.ENV.engine.tidy(function () {\n            var x = xs1d[i];\n            if (i > 0) {\n                for (var j = 0; j < i; ++j) {\n                    var proj = reduction_ops_1.sum(ys[j].mulStrict(x)).mul(ys[j]);\n                    x = x.sub(proj);\n                }\n            }\n            return x.div(norm_1.norm(x, 'euclidean'));\n        }));\n    };\n    for (var i = 0; i < xs.length; ++i) {\n        _loop_1(i);\n    }\n    if (inputIsTensor2D) {\n        return array_ops_1.stack(ys, 0);\n    }\n    else {\n        return ys;\n    }\n}\nfunction qr_(x, fullMatrices) {\n    if (fullMatrices === void 0) { fullMatrices = false; }\n    if (x.rank < 2) {\n        throw new Error(\"qr() requires input tensor to have a rank >= 2, but got rank \" + x.rank);\n    }\n    else if (x.rank === 2) {\n        return qr2d(x, fullMatrices);\n    }\n    else {\n        var outerDimsProd = x.shape.slice(0, x.shape.length - 2)\n            .reduce(function (value, prev) { return value * prev; });\n        var x2ds = array_ops_1.unstack(x.reshape([\n            outerDimsProd, x.shape[x.shape.length - 2],\n            x.shape[x.shape.length - 1]\n        ]), 0);\n        var q2ds_1 = [];\n        var r2ds_1 = [];\n        x2ds.forEach(function (x2d) {\n            var _a = qr2d(x2d, fullMatrices), q2d = _a[0], r2d = _a[1];\n            q2ds_1.push(q2d);\n            r2ds_1.push(r2d);\n        });\n        var q = array_ops_1.stack(q2ds_1, 0).reshape(x.shape);\n        var r = array_ops_1.stack(r2ds_1, 0).reshape(x.shape);\n        return [q, r];\n    }\n}\nfunction qr2d(x, fullMatrices) {\n    if (fullMatrices === void 0) { fullMatrices = false; }\n    return environment_1.ENV.engine.tidy(function () {\n        if (x.shape.length !== 2) {\n            throw new Error(\"qr2d() requires a 2D Tensor, but got a \" + x.shape.length + \"D Tensor.\");\n        }\n        var m = x.shape[0];\n        var n = x.shape[1];\n        var q = array_ops_1.eye(m);\n        var r = x.clone();\n        var one2D = tensor_ops_1.tensor2d([[1]], [1, 1]);\n        var w = one2D.clone();\n        var iters = m >= n ? n : m;\n        var _loop_2 = function (j) {\n            var _a;\n            var rTemp = r;\n            var wTemp = w;\n            var qTemp = q;\n            _a = environment_1.ENV.engine.tidy(function () {\n                var rjEnd1 = r.slice([j, j], [m - j, 1]);\n                var normX = rjEnd1.norm();\n                var rjj = r.slice([j, j], [1, 1]);\n                var s = rjj.sign().neg();\n                var u1 = rjj.sub(s.mul(normX));\n                var wPre = rjEnd1.div(u1);\n                if (wPre.shape[0] === 1) {\n                    w = one2D.clone();\n                }\n                else {\n                    w = one2D.concat(wPre.slice([1, 0], [wPre.shape[0] - 1, wPre.shape[1]]), 0);\n                }\n                var tau = s.matMul(u1).div(normX).neg();\n                var rjEndAll = r.slice([j, 0], [m - j, n]);\n                var tauTimesW = tau.mul(w);\n                if (j === 0) {\n                    r = rjEndAll.sub(tauTimesW.matMul(w.transpose().matMul(rjEndAll)));\n                }\n                else {\n                    r = r.slice([0, 0], [j, n])\n                        .concat(rjEndAll.sub(tauTimesW.matMul(w.transpose().matMul(rjEndAll))), 0);\n                }\n                var qAllJEnd = q.slice([0, j], [m, q.shape[1] - j]);\n                if (j === 0) {\n                    q = qAllJEnd.sub(qAllJEnd.matMul(w).matMul(tauTimesW.transpose()));\n                }\n                else {\n                    q = q.slice([0, 0], [m, j])\n                        .concat(qAllJEnd.sub(qAllJEnd.matMul(w).matMul(tauTimesW.transpose())), 1);\n                }\n                return [w, r, q];\n            }), w = _a[0], r = _a[1], q = _a[2];\n            globals_1.dispose([rTemp, wTemp, qTemp]);\n        };\n        for (var j = 0; j < iters; ++j) {\n            _loop_2(j);\n        }\n        if (!fullMatrices && m > n) {\n            q = q.slice([0, 0], [m, n]);\n            r = r.slice([0, 0], [n, n]);\n        }\n        return [q, r];\n    });\n}\nexports.gramSchmidt = operation_1.op({ gramSchmidt_: gramSchmidt_ });\nexports.qr = operation_1.op({ qr_: qr_ });\n"},"sourceMaps":{"js":{"version":3,"file":"linalg_ops.js","sourceRoot":"","sources":["../../src/ops/linalg_ops.ts"],"names":[],"mappings":"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","sourcesContent":[null]}},"error":null,"hash":"ce57de1c92461a50eee669447158bf5e","cacheData":{"env":{}}}