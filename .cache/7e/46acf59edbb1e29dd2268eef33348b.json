{"id":"node_modules/@tensorflow/tfjs-core/dist/kernels/webgl/reduce_gpu.js","dependencies":[{"name":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\kernels\\webgl\\reduce_gpu.js.map","includedInParent":true,"mtime":499162500000},{"name":"E:\\htr-final\\package.json","includedInParent":true,"mtime":1603094551417},{"name":"E:\\htr-final\\.babelrc","includedInParent":true,"mtime":1603022514142},{"name":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\package.json","includedInParent":true,"mtime":1603088140582}],"generated":{"js":"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ReduceProgram = (function () {\n    function ReduceProgram(reduceInfo, reduceType) {\n        this.variableNames = ['x'];\n        var windowSize = reduceInfo.windowSize;\n        var batchSize = reduceInfo.batchSize;\n        var inSize = reduceInfo.inSize;\n        var outSize = Math.ceil(inSize / windowSize);\n        this.outputShape = [batchSize, outSize];\n        var initializationValue = '0.0';\n        var compareOp = \"\";\n        if (reduceType === 'min') {\n            initializationValue = '1.0 / 0.0';\n            compareOp = \"min\";\n        }\n        else if (reduceType === 'max') {\n            initializationValue = '-1.0 / 0.0';\n            compareOp = \"max\";\n        }\n        var returnValue = reduceType + \"(\" + reduceType + \"(\" + reduceType + \"(\" +\n            'minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])';\n        if (reduceType === 'sum') {\n            returnValue = \"sumValue\";\n        }\n        else if (reduceType === 'all') {\n            returnValue = \"allValue\";\n        }\n        else if (reduceType === 'any') {\n            returnValue = \"anyValue\";\n        }\n        var windowSizeNearestVec4 = Math.floor(windowSize / 4) * 4;\n        var windowSizeVec4Remainder = windowSize % 4;\n        var updateSnippet = \"\\n      if (\" + (reduceType === 'sum') + \") {\\n        sumValue += dot(values, ones);\\n      } else {\\n        minMaxValue = \" + compareOp + \"(values, minMaxValue);\\n      }\\n    \";\n        var vecType = \"vec4\";\n        if (reduceType === 'all') {\n            initializationValue = '1.0';\n            updateSnippet = \"\\n        bool reducedAllValue = all(values);\\n        float floatedReducedAllValue = float(reducedAllValue);\\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\\n      \";\n            vecType = \"bvec4\";\n        }\n        else if (reduceType === 'any') {\n            initializationValue = '0.0';\n            updateSnippet = \"\\n        bool reducedAnyValue = any(values);\\n        float floatedReducedAnyValue = float(reducedAnyValue);\\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\\n      \";\n            vecType = \"bvec4\";\n        }\n        var checkOutOfBounds = '';\n        if (inSize % windowSize > 0) {\n            checkOutOfBounds = \"\\n        if (inIdx < 0 || inIdx >= \" + inSize + \") {\\n          return initializationValue;\\n        }\\n      \";\n        }\n        this.userCode = \"\\n      const float initializationValue = \" + initializationValue + \";\\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\\n\\n      float getValue(int batch, int inIdx) {\\n        \" + checkOutOfBounds + \"\\n        return getX(batch, inIdx);\\n      }\\n\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int outIdx = coords[1];\\n        int inOffset = outIdx * \" + windowSize + \";\\n\\n        vec4 minMaxValue = vec4(\" + initializationValue + \");\\n        float sumValue = 0.0;\\n        float allValue = 1.0;\\n        float anyValue = 0.0;\\n\\n        for (int i = 0; i < \" + windowSizeNearestVec4 + \"; i += 4) {\\n          int inIdx = inOffset + i;\\n          \" + vecType + \" values = \" + vecType + \"(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            getValue(batch, inIdx + 2),\\n            getValue(batch, inIdx + 3)\\n          );\\n\\n          \" + updateSnippet + \"\\n        }\\n\\n        int inIdx = inOffset + \" + windowSizeNearestVec4 + \";\\n        if (\" + (windowSizeVec4Remainder === 1) + \") {\\n          \" + vecType + \" values = \" + vecType + \"(\\n            getValue(batch, inIdx),\\n            initializationValue,\\n            initializationValue,\\n            initializationValue\\n          );\\n\\n          \" + updateSnippet + \"\\n        } else if (\" + (windowSizeVec4Remainder === 2) + \") {\\n          \" + vecType + \" values = \" + vecType + \"(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            initializationValue,\\n            initializationValue\\n          );\\n\\n          \" + updateSnippet + \"\\n        } else if (\" + (windowSizeVec4Remainder === 3) + \") {\\n          \" + vecType + \" values = \" + vecType + \"(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            getValue(batch, inIdx + 2),\\n            initializationValue\\n          );\\n\\n          \" + updateSnippet + \"\\n        }\\n        setOutput(\" + returnValue + \");\\n      }\\n    \";\n    }\n    return ReduceProgram;\n}());\nexports.ReduceProgram = ReduceProgram;\n"},"sourceMaps":{"js":{"version":3,"file":"reduce_gpu.js","sourceRoot":"","sources":["../../../src/kernels/webgl/reduce_gpu.ts"],"names":[],"mappings":";;AAoBA;IAKE,uBACI,UAAsB,EAAE,UAAyC;QALrE,kBAAa,GAAG,CAAC,GAAG,CAAC,CAAC;QAMpB,IAAM,UAAU,GAAG,UAAU,CAAC,UAAU,CAAC;QACzC,IAAM,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC;QACvC,IAAM,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC;QACjC,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,UAAU,CAAC,CAAC;QAC/C,IAAI,CAAC,WAAW,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;QAExC,IAAI,mBAAmB,GAAG,KAAK,CAAC;QAChC,IAAI,SAAS,GAAG,EAAE,CAAC;QAEnB,IAAI,UAAU,KAAK,KAAK,EAAE;YACxB,mBAAmB,GAAG,WAAW,CAAC;YAClC,SAAS,GAAG,KAAK,CAAC;SACnB;aAAM,IAAI,UAAU,KAAK,KAAK,EAAE;YAC/B,mBAAmB,GAAG,YAAY,CAAC;YACnC,SAAS,GAAG,KAAK,CAAC;SACnB;QAED,IAAI,WAAW,GAAM,UAAU,SAAI,UAAU,SAAI,UAAU,MAAG;YAC1D,mEAAmE,CAAC;QAExE,IAAI,UAAU,KAAK,KAAK,EAAE;YACxB,WAAW,GAAG,UAAU,CAAC;SAC1B;aAAM,IAAI,UAAU,KAAK,KAAK,EAAE;YAC/B,WAAW,GAAG,UAAU,CAAC;SAC1B;aAAM,IAAI,UAAU,KAAK,KAAK,EAAE;YAC/B,WAAW,GAAG,UAAU,CAAC;SAC1B;QAED,IAAM,qBAAqB,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QAC7D,IAAM,uBAAuB,GAAG,UAAU,GAAG,CAAC,CAAC;QAE/C,IAAI,aAAa,GAAG,kBACZ,UAAU,KAAK,KAAK,4FAGR,SAAS,0CAE5B,CAAC;QAEF,IAAI,OAAO,GAAG,MAAM,CAAC;QAErB,IAAI,UAAU,KAAK,KAAK,EAAE;YACxB,mBAAmB,GAAG,KAAK,CAAC;YAC5B,aAAa,GAAG,oMAIf,CAAC;YACF,OAAO,GAAG,OAAO,CAAC;SACnB;aAAM,IAAI,UAAU,KAAK,KAAK,EAAE;YAC/B,mBAAmB,GAAG,KAAK,CAAC;YAC5B,aAAa,GAAG,oMAIf,CAAC;YACF,OAAO,GAAG,OAAO,CAAC;SACnB;QAED,IAAI,gBAAgB,GAAG,EAAE,CAAC;QAC1B,IAAI,MAAM,GAAG,UAAU,GAAG,CAAC,EAAE;YAC3B,gBAAgB,GAAG,yCACW,MAAM,kEAGnC,CAAC;SACH;QACD,IAAI,CAAC,QAAQ,GAAG,+CACsB,mBAAmB,sHAInD,gBAAgB,0NAQQ,UAAU,6CAEV,mBAAmB,uIAKvB,qBAAqB,oEAEvC,OAAO,kBAAa,OAAO,oMAO3B,aAAa,sDAGQ,qBAAqB,wBACxC,uBAAuB,KAAK,CAAC,wBAC/B,OAAO,kBAAa,OAAO,+KAO3B,aAAa,8BACJ,uBAAuB,KAAK,CAAC,wBACtC,OAAO,kBAAa,OAAO,sLAO3B,aAAa,8BACJ,uBAAuB,KAAK,CAAC,wBACtC,OAAO,kBAAa,OAAO,6LAO3B,aAAa,uCAEL,WAAW,sBAE1B,CAAC;IACJ,CAAC;IACH,oBAAC;AAAD,CAAC,AA3ID,IA2IC;AA3IY,sCAAa","sourcesContent":[null]}},"error":null,"hash":"3d3a3daa310937a2ddb43aac970375d2","cacheData":{"env":{}}}