{"id":"node_modules/@tensorflow/tfjs-core/dist/ops/pool.js","dependencies":[{"name":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\pool.js.map","includedInParent":true,"mtime":499162500000},{"name":"E:\\htr-final\\package.json","includedInParent":true,"mtime":1603094551417},{"name":"E:\\htr-final\\.babelrc","includedInParent":true,"mtime":1603022514142},{"name":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\package.json","includedInParent":true,"mtime":1603088140582},{"name":"../environment","loc":{"line":3,"column":28},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\pool.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\environment.js"},{"name":"../tensor_util_env","loc":{"line":4,"column":32},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\pool.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\tensor_util_env.js"},{"name":"../util","loc":{"line":5,"column":19},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\pool.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\util.js"},{"name":"./conv_util","loc":{"line":6,"column":24},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\pool.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\conv_util.js"},{"name":"./operation","loc":{"line":7,"column":26},"parent":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\pool.js","resolved":"E:\\htr-final\\node_modules\\@tensorflow\\tfjs-core\\dist\\ops\\operation.js"}],"generated":{"js":"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar environment_1 = require(\"../environment\");\nvar tensor_util_env_1 = require(\"../tensor_util_env\");\nvar util = require(\"../util\");\nvar conv_util = require(\"./conv_util\");\nvar operation_1 = require(\"./operation\");\nfunction maxPool_(x, filterSize, strides, pad, dimRoundingMode) {\n    var $x = tensor_util_env_1.convertToTensor(x, 'x', 'maxPool');\n    var x4D = $x;\n    var reshapedTo4D = false;\n    if ($x.rank === 3) {\n        reshapedTo4D = true;\n        x4D = $x.as4D(1, $x.shape[0], $x.shape[1], $x.shape[2]);\n    }\n    util.assert(x4D.rank === 4, \"Error in maxPool: input must be rank 4 but got rank \" + x4D.rank + \".\");\n    if (dimRoundingMode != null) {\n        util.assert(util.isInt(pad), \"Error in maxPool: pad must be an integer when using, \" +\n            (\"dimRoundingMode \" + dimRoundingMode + \" but got pad \" + pad + \".\"));\n    }\n    var convInfo = conv_util.computePool2DInfo(x4D.shape, filterSize, strides, pad, dimRoundingMode);\n    var grad = function (dy, saved) {\n        var y4D = saved[0];\n        return {\n            x: function () {\n                return maxPoolBackprop(dy, x4D, y4D, filterSize, strides, pad);\n            }\n        };\n    };\n    var res = environment_1.ENV.engine.runKernel(function (backend, save) { return save(backend.maxPool(x4D, convInfo)); }, { x: x4D }, grad);\n    if (reshapedTo4D) {\n        return res.as3D(res.shape[1], res.shape[2], res.shape[3]);\n    }\n    return res;\n}\nfunction avgPool_(x, filterSize, strides, pad, dimRoundingMode) {\n    var $x = tensor_util_env_1.convertToTensor(x, 'x', 'avgPool');\n    util.assert($x.dtype === 'float32', 'The input dtype to avgPool must be float32');\n    var x4D = $x;\n    var reshapedTo4D = false;\n    if ($x.rank === 3) {\n        reshapedTo4D = true;\n        x4D = $x.as4D(1, $x.shape[0], $x.shape[1], $x.shape[2]);\n    }\n    util.assert(x4D.rank === 4, \"Error in avgPool: x must be rank 4 but got rank \" + x4D.rank + \".\");\n    if (dimRoundingMode != null) {\n        util.assert(util.isInt(pad), \"Error in avgPool: pad must be an integer when using, \" +\n            (\"dimRoundingMode \" + dimRoundingMode + \" but got pad \" + pad + \".\"));\n    }\n    var convInfo = conv_util.computePool2DInfo(x4D.shape, filterSize, strides, pad);\n    var grad = function (dy) {\n        return { x: function () { return avgPoolBackprop(dy, x4D, filterSize, strides, pad); } };\n    };\n    var res = environment_1.ENV.engine.runKernel(function (backend) { return backend.avgPool(x4D, convInfo); }, { x: x4D }, grad);\n    res = res.cast($x.dtype);\n    if (reshapedTo4D) {\n        return res.as3D(res.shape[1], res.shape[2], res.shape[3]);\n    }\n    return res;\n}\nfunction maxPoolBackprop(dy, input, output, filterSize, strides, pad, dimRoundingMode) {\n    var $dy = tensor_util_env_1.convertToTensor(dy, 'dy', 'maxPoolBackprop');\n    var $input = tensor_util_env_1.convertToTensor(input, 'input', 'maxPoolBackprop');\n    var $output = tensor_util_env_1.convertToTensor(output, 'output', 'maxPoolBackprop');\n    util.assert($input.rank === $dy.rank, \"Rank of input (\" + $input.rank + \") does not match rank of dy (\" + $dy.rank + \")\");\n    util.assert($dy.rank === 4, \"Error in maxPoolBackprop: dy must be rank 4 but got rank \" +\n        ($dy.rank + \".\"));\n    util.assert($input.rank === 4, \"Error in maxPoolBackprop: input must be rank 4 but got rank \" +\n        ($input.rank + \".\"));\n    if (dimRoundingMode != null) {\n        util.assert(util.isInt(pad), \"Error in maxPoolBackprop: pad must be an integer when using, \" +\n            (\"dimRoundingMode \" + dimRoundingMode + \" but got pad \" + pad + \".\"));\n    }\n    var convInfo = conv_util.computePool2DInfo($input.shape, filterSize, strides, pad, dimRoundingMode);\n    var res = environment_1.ENV.engine.runKernel(function (backend) { return backend.maxPoolBackprop($dy, $input, $output, convInfo); }, { $dy: $dy, $input: $input });\n    return res;\n}\nfunction avgPoolBackprop(dy, input, filterSize, strides, pad) {\n    var $dy = tensor_util_env_1.convertToTensor(dy, 'dy', 'avgPoolBackprop');\n    var $input = tensor_util_env_1.convertToTensor(input, 'input', 'avgPoolBackprop');\n    util.assert($input.rank === $dy.rank, \"Rank of input (\" + $input.rank + \") does not match rank of dy (\" + $dy.rank + \")\");\n    var input4D = $input;\n    var dy4D = $dy;\n    var reshapedTo4D = false;\n    if ($input.rank === 3) {\n        reshapedTo4D = true;\n        input4D = $input.as4D(1, $input.shape[0], $input.shape[1], $input.shape[2]);\n        dy4D = $dy.as4D(1, $dy.shape[0], $dy.shape[1], $dy.shape[2]);\n    }\n    util.assert(dy4D.rank === 4, \"Error in avgPoolBackprop: dy must be rank 4 but got rank \" +\n        (dy4D.rank + \".\"));\n    util.assert(input4D.rank === 4, \"Error in avgPoolBackprop: input must be rank 4 but got rank \" +\n        (input4D.rank + \".\"));\n    var convInfo = conv_util.computePool2DInfo(input4D.shape, filterSize, strides, pad);\n    var res = environment_1.ENV.engine.runKernel(function (backend) { return backend.avgPoolBackprop(dy4D, input4D, convInfo); }, { dy4D: dy4D, input4D: input4D });\n    if (reshapedTo4D) {\n        return res.as3D(res.shape[1], res.shape[2], res.shape[3]);\n    }\n    return res;\n}\nexports.maxPool = operation_1.op({ maxPool_: maxPool_ });\nexports.avgPool = operation_1.op({ avgPool_: avgPool_ });\n"},"sourceMaps":{"js":{"version":3,"file":"pool.js","sourceRoot":"","sources":["../../src/ops/pool.ts"],"names":[],"mappings":"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","sourcesContent":[null]}},"error":null,"hash":"6929ee3dbac7d894187dd2aab6278814","cacheData":{"env":{}}}